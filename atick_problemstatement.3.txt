End to End Privacy Enabled Mapping System Problem Statement

Identifier Locator Systems like ILA, ILNP, and LISP are proposed as a revolutionary approach to enabling direct routing in the upcoming converged communication networks such as 5G core network (5GC) rather than using tunneling with GTP-U, GRE, (P)MIPv6 or similar ones. In addition to increasing packet overhead due to encapsulation that may cause fragmentation and all related issues typical disadvantages of (especially static end-to-end) tunneling comprise inflexibility to properly react to dynamic changes of end points and potential on-path anchors. Added complexity in case of multicast traffic and increased signaling for tunnel management are further drawbacks. Tunnels may introduce vulnerabilities or add to the potential for receiver overload and thus DOS attacks [draft-ietf-intarea-tunnels-08]. Finally without other measures such as deep packet inspection optimization of paths according to network resources and application needs becomes complex. 

With the Id-Loc systems a mapping system needs to be established so that 5GC nodes or functions can access the identifier and locator values of the destination given the source identifier and locator values to enable them to route the packet towards the destination. For mapping systems there will be a trade-off between scalability and rapid processing versus privacy and security of data. 

A public distributed database such as the DNS is used by end hosts for host name (or FQDN) to identifier mapping usually to start the communication. DNS can be used to publicly access identifiers. However, using DNS for locator access brings the issue that any node in the internet can query and track the location of the roaming UEs in 5G network which is not desirable. A separate database called a mapping system needs to be used for identifier to locator mapping. Such a mapping system need not be public in order to avoid that any node can write new mapping pairs or ID-Loc bindings in such a database. 



Currently proposed approaches to mapping systems can be summarized as follows. 

1.	ILNP uses DNS for identifier to locator mapping. RFC 6742 defines DNS resource records for identifier called NID and locator called L64 for IPv6 and L32 for IPv4. This allows the end nodes to obtain the destination identifier for a given Fully Qualified Domain Name (FQDN). However the same node also gets the locator values raising serious privacy issues. ILNP outlines locator and identifier privacy solutions in RFC 6748. Source locator privacy can be preserved by the use of a Locator Rewriting Relay (LRR) on the path from the source to the destination, e.g. when a UE is in communication with a remote server. A LRR provides a mapping between a localised source locator value to a different locator value, e.g. a globally routable locator, re-writing the packet's source locator value with the new locator value. The LRR also handles the reverse path mapping to the source for return packets. For source identifier privacy, ILNP allows the use of any privacy mechanisms defined for IPv6 identifiers, e.g. ephemeral-use identifier values, ala RFC 4941, or (better) RFC 8064. 

For incoming connections to an ILNP node, the identifier and locator values are stored in DNS as described above, i.e. ILNP does not define a mapping system. For a 5G network, this could be an internal ("private") DNS system, only accessible via the provider. However, it would be possible to define other mapping systems from names to identifier/locator values, or, for example, from E.164 numbers to ILNPv6 NID/L64 values. In general, if the source identifier for a UE is known to a remote entity, there is the potential for communication packets to be linked to a node. If the source locator of a UE is known to a remote entity, there is the potential for topological (and possibly geographical) location of that UE to become known. Also, there are concerns on the write operation efficiency for DNS data store, I.e. Dynamic DNS in the face of 5G level handovers.
 

2.	In LISP, FQDN to identifier or EID mappings are stored in DNS. The LISP control-plane interface to the identifier-locator or EID-RLOC mapping system is defined in RFC6833. The LISP mapping transport system (LISP-DDT and LISP-ALT) are defined in RFC6836 and RFC8111, respectively. LISP data plane nodes, Ingress/Egress Tunnel Routers (ITR/ETR or xTR) registers mappings to the mapping system by sending Map-Register messages to the Map-Server(s). The MAP Server then publishes these identifier locator values in a mapping database. There is Map-Resolver which accepts Map-Request messages from an ITR for the EID and returns the corresponding EID-to-RLOC-set mappings by consulting mapping database system in a Map-Reply message.  All messages defined in the control plane are UDP messages. All read and write operations to the mapping system are authenticated with shared-keys using sha256 as well as ECDSA similar to DNSSEC.  Note that ITRs keep a small scale identifier locator map of all values learned so far called a cache.  In LISP mapping system, the lack of privacy support for a given identifier value exists. Since ITR uses request/response exchange in getting the locator values, until a resolution response is received, packets for a flow are blocked. This means a Denial of Service attack on the ITR or cache has the worst case effect of indefinitely blocking a legitimate flow. Also the cache in ITR may raise privacy issue if EID-RLOC values for one UE is used for another UE.

3.	ILA is currently using a distributed key value (KV) store (redis database) for identifier locator mapping [draft-herbert-ila-ilamp-00.txt]. The key value NoSQL database also supports publish/subscribe where the senders or publishers send the messages while the receivers or subscribers receive them and the link by which the messages are transferred is called channel. Such an approach avoids developing a request response protocol in order to update the mapping database with new identifier locator values or to access locator values for a given identifier and also leverages all the recent developments for security, availability, reliability, replication, etc. ILA forwarding nodes (ILA-N) maintain caches of identifier locator values learned so far but these values are UE specific. The ILA Mapping Protocol (ILAMP) is used between ILA forwarding nodes and ILA mapping routers (ILA-R). The purpose of the protocol is to populate and maintain the ILA mapping cache in forwarding nodes. ILA-N sends Map Request message to ILA-R with a list of identifiers and ILA-R replies with Map Information message with identifier to locator mappings. ILA-R contains a horizontal partition of the whole identifier locator database called a shard. LISP style request/response protocol based mapping system can also be used by ILA as defined in [draft-rodrigueznatal-ila-lisp-00].

Privacy is addressed by way of UE simultaneously using different addresses for different connections by using a block of addresses. It is observed that NAT can also provide address privacy but the use of NAT is discouraged in IETF. UE needs to reestablish connections every time it changes its address so address changing incurs delays which could be significant in case of real-time communication unless connections can be made simultaneously. 

  


Next, we identify the following gaps:

The use of new type of databases known as NoSQL databases organized as Key-value stores or mapping systems. Such databases will provide very efficient read and writes unlike DNS. NoSQL mapping systems mostly support a message-oriented middleware system called publish-subscribe or PubSub. In PubSub, publishers are loosely coupled to subscribers and offer better scalability than traditional client-server systems because of parallel operation, message caching and network based message routing. Such systems support sharding based on a shard key across different database servers. Publish/subscribe mechanism takes cares of the request/response mechanism commonly used in DNS or other mapping systems and have better DDOS protection. Although a proposal exists as in [3] above, how such a Key-value store will be architectured in 5GC is not defined. Some guidelines for sharding need to be developed. How the mapping database will be sharded based on its identifier values as the key differently for each Id-Loc system can be defined.

What is stored in the mapping system is limited to the identifier and locator values and no considerations to provide privacy of the stored data.

There are many privacy improving mechanisms defined like locator/identifier privacy of ILNP discussed in [1] above, frequent address changing of ILA discussed in [3] above, establishing and managing security associations between participating entities etc. Each of these techniques can be used by any Id-loc system. There is a need to standardize these privacy techniques in order to enable wide scale use by the end nodes.

We address privacy problem for mapping systems: First we state the Atick privacy model which can be summarized as privacy at every levels. At the mapping system, the map data will be designed with privacy considerations so that the access will be enabled only for the allowed entities and disabled for any others. 5GC nodes/functions that are ingress/egress nodes may have caches and a protocol may be needed to communicate with other 5GC nodes that are part of the mapping servers and contains a shard. 5GC nodes/functions that are not ingress/egress nodes are considered part of the mapping servers and they provide secure access to the mapping data and may contain part of the mapping database. Privacy will be enabled in all 5GC nodes/functions that deal with the mapping database. Such considerations will be implemented by way of the privacy additions to the data stored in the mapping database. End hosts or UEs will be able to have control over their own mapping records stored in the mapping database. End nodes or UEs that are unauthorized will not be able to have access to the location data of another UE. The same applies to the unauthorized entities or servers/functions in what 5G architecture calls outside data network (DN).
 

